<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>control_panel</title>
</head>
<body>
  <div class="container">
    <form action="/nngarage/upload-nn-desc" method="post">
      <input type="text" id="nn_desc_name" name="nn_desc_name">
      <input type="file" id="nn_desc_filename" name="nn_desc_filename">
      <input type="submit">
    </form>
    <ul id="nn_desc_list"></ul>
  </div> <!-- /container -->
  <script>
    function populateList() {
    $.get("/nngarage/get-nn-desc").done(function(data){
       var list = $("#post-list");
        list.html('');

        for (var i = 0; i < data.net_desc_metas.length; i++) {
            nn_desc = data.net_desc_metas[i];
            var new_post = $(nn_desc.name) + " " + $(nn_desc.dateTime);
            new_post.data("post-id", post.id);
            list.prepend(new_post);
        }
    });
}


    $(document).ready(function () {
    // TODO: add handler for the post button
    populateList();

    window.setInterval(getUpdates, 5000);

    // CSRF set-up copied from Django docs
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    var csrftoken = getCookie('csrftoken');
    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
      });
    });
  </script>
</body>
</html>